---
title: "shotscore-by-player"
author: "Kyle Cox"
date: "11/15/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(scipen = 100)
```

Still not liking the way this residual plot is looking
stuff is a little too smooth right now

we can't have the variance being so different along the residuals... it makes identifying "luck" much harder

using smaller sigma will solve this

wish there were a way to iterate with different values of sigma but whatever i am using now is too much

using sigma == 1 is allowing things to peak around -.95... tbh shoudl solve all of these problems

if residuals display equal variance then we can justify using the residuals to measure "luck" - i.e. the success in shooting percentage not explained by ball accuracy***

important shit

ideally we would be able to fit a y = x linear regression to this but we don't really even need to use regression

```{r}
data = read.csv('/Users/kylecox/Documents/UT/SDS 379R/beyondbinary/src/beyondbinary/player_shotscore.csv')


#res = resid(fit)
#data.filtered$luck = data.filtered$outcome - data.filtered$shotScore
#plot(data.filtered$outcome, res)
#abline(0, 0)
```

```{r}
data.incomplete = data[data$n > 100,]

plot(data$ss_prorated, data$pct, xlim=c(20, 50), ylim=c(20,50), xlab='Shot Score (Prorated)', ylab='Three-Point Percentage', main='Mean Accuracy versus Mean Shot Score for Players with over 100 attempts')

fit = lm(ss_prorated ~ pct + 0, data=data)
abline(fit)
summary(fit)
```






Note: the regression is looking perfect now. With really low sigma it is super close to y = x... this is good

```{r}
hist(data.filtered$shotScore)
hist(data.filtered$outcome)
mean(data.filtered$shotScore)
mean(data.filtered$outcome)
```

```{r}
plot(data.filtered$n, data.filtered$adjustedAccuracy, ylab='Adjusted Shot Accuracy', xlab='Volume')
text(data.filtered$n, data.filtered$adjustedAccuracy, labels=data.filtered$lastName)
```

Histograms are looking very similar... that is also good

```{r}
summary(data.filtered$adjustedAccuracy)
```





LUCK should have nothing to do with linear regression... it should simply be the 3P% - average shot score

we use linear regression to instead show talent. we have a model that predicts the shotscore from the given variables, and then we compare the true shotscore to the predicted values... these residuals are how much better a player shot than we expected before the shot took place

... only use variables you can know before the shot is launched (distance, defender, type of shot) and definitely don't include player name as a hot encoded variable because in that case we are no longer evaluating how much better a player shoots

... but you can also have a model for each player and use that to evaluate on an individual shot basis which shots were good and which were not (but that seems less useful to me)

TODO: run an anova on different types of shots and determine the "type of shot effect" for each one. then you can adjust for it and make a measure "true shot score"



